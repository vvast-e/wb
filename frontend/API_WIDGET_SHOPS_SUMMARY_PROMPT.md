# Промт для генерации API endpoint'ов для виджетов "Сводка по магазинам"

## Описание задачи

Требуется реализовать API для страницы "Сводка по магазинам" с двумя независимыми виджетами (Wildberries и Ozon). Каждый виджет отображает краткую аналитику по отзывам, поддерживает фильтрацию по бренду, товару, периоду, мульти-параметрам отображения, а также выводит топы (товары и причины негатива).

---

## Требуемые endpoint'ы

### 1. Получение брендов для магазина
- **GET** `/api/brands?shop=wb|ozon`
- **Параметры:**
  - `shop` — строка, обязательный (`wb` или `ozon`)
- **Ответ:**
```json
[
  { "id": 1, "name": "Brand A" },
  { "id": 2, "name": "Brand B" }
]
```

### 2. Получение товаров по бренду и магазину
- **GET** `/api/products?shop=wb|ozon&brand_id=1`
- **Параметры:**
  - `shop` — строка, обязательный
  - `brand_id` — число, обязательный
- **Ответ:**
```json
[
  { "id": 101, "name": "Product X" },
  { "id": 102, "name": "Product Y" }
]
```

### 3. Получение краткой статистики по отзывам (для графика)
- **GET** `/api/reviews/summary`
- **Параметры:**
  - `shop` — строка, обязательный (`wb` или `ozon`)
  - `brand_id` — число, необязательный
  - `product_id` — число, необязательный
  - `date_from` — строка (YYYY-MM-DD), обязательный
  - `date_to` — строка (YYYY-MM-DD), обязательный
  - `metrics` — список строк, обязательный (например: `metrics=negative,negative_share,deleted`)
  - `filters` — строка/JSON, необязательный (например, фильтрация по рейтингу, удалённости и т.д.)
- **Ответ:**
```json
{
  "total_reviews": 1234,
  "by_day": [
    { "date": "2024-06-01", "negative": 7, "negative_share": 12, "deleted": 2 },
    { "date": "2024-06-02", "negative": 13, "negative_share": 15, "deleted": 3 }
  ]
}
```

### 4. Получение топов (товары и причины негатива)
- **GET** `/api/reviews/tops`
- **Параметры:**
  - `shop` — строка, обязательный
  - `brand_id` — число, необязательный
  - `product_id` — число, необязательный
  - `date_from` — строка, обязательный
  - `date_to` — строка, обязательный
  - `type` — строка, обязательный (`products_negative`, `reasons_negative`)
- **Ответ:**
```json
[
  { "name": "Product X", "value": 17 },
  { "name": "Product Y", "value": 12 }
]
```

---

## Особенности:
- Все фильтры из выпадающего списка "Параметры для отображения" должны поддерживаться через параметры запроса (например, фильтрация по рейтингу, удалённости и т.д.).
- Для мульти-параметров (несколько метрик на графике) параметр `metrics` принимает список значений.
- Для топов тип топа задаётся параметром `type`.
- Ответы должны быть быстрыми, поддерживать пагинацию при необходимости (например, для топов).

---

## Пример последовательности запросов для одного виджета:
1. Получить бренды: `/api/brands?shop=wb`
2. Получить товары выбранного бренда: `/api/products?shop=wb&brand_id=1`
3. Получить данные для графика: `/api/reviews/summary?shop=wb&brand_id=1&product_id=101&date_from=2024-06-01&date_to=2024-06-10&metrics=negative,negative_share`
4. Получить топ товаров: `/api/reviews/tops?shop=wb&brand_id=1&date_from=2024-06-01&date_to=2024-06-10&type=products_negative`
5. Получить топ причин негатива: `/api/reviews/tops?shop=wb&brand_id=1&date_from=2024-06-01&date_to=2024-06-10&type=reasons_negative`

---

## Требования к реализации:
- Все endpoint'ы должны быть RESTful, поддерживать фильтрацию и мульти-параметры.
- Ответы должны быть оптимизированы для фронтенда (минимум лишних данных, максимум скорости).
- Структура и названия параметров должны быть согласованы с фронтендом. 